<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Repair Phone BX - R√©paration iPhone</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root { 
            --primary: #ff5c39; --dark: #1d1d1f; --bg-body: #fbfbfd; 
            --green-gradient: linear-gradient(180deg, #34c759 0%, #30b753 100%);
            --radius-md: 18px; --shadow-sm: 0 2px 8px rgba(0,0,0,0.04); --shadow-hover: 0 20px 40px rgba(0,0,0,0.1);
            --promo: #ff3b30;
        }
        * { box-sizing: border-box; }
        body { font-family: 'Inter', sans-serif; margin: 0; color: var(--dark); background-color: var(--bg-body); scroll-behavior: smooth; }
        
        header { padding: 15px 40px; display: flex; justify-content: space-between; align-items: center; position: sticky; top: 0; background: rgba(255,255,255,0.85); backdrop-filter: blur(20px); z-index: 1000; border-bottom: 1px solid rgba(0,0,0,0.05); }
        .logo { font-size: 22px; font-weight: 700; color: var(--dark); }
        .btn-contact { background: var(--dark); color: white; padding: 10px 22px; border-radius: 99px; cursor: pointer; border: none; font-weight: 600; }

        .hero { background: linear-gradient(135deg, #ffffff 0%, #fff8f6 100%); padding: 60px 20px; max-width: 1200px; margin: 30px auto; border-radius: 24px; text-align: center; box-shadow: var(--shadow-sm); border: 1px solid rgba(0,0,0,0.03); }
        .promo-banner { background: linear-gradient(90deg, #ff5c39, #ff3b30); color: white; padding: 8px 16px; border-radius: 99px; font-weight: 700; text-transform: uppercase; font-size: 11px; display: inline-block; margin-bottom: 20px; }
        .hero h1 { font-size: 42px; margin: 0 0 10px 0; color: #1d1d1f; }

        /* BARRE DE RECHERCHE */
        .search-container { max-width: 600px; margin: 0 auto 40px auto; position: relative; }
        .search-input { width: 100%; padding: 16px 50px; border: 1px solid #ddd; border-radius: 99px; font-size: 16px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); transition: 0.3s; }
        .search-input:focus { outline: none; border-color: var(--primary); box-shadow: 0 4px 15px rgba(255, 92, 57, 0.15); }
        .search-icon { position: absolute; left: 20px; top: 50%; transform: translateY(-50%); font-size: 20px; color: #999; }

        .container { display: flex; max-width: 1200px; margin: 0 auto; padding: 0 20px 80px 20px; gap: 40px; }
        
        .sidebar { width: 240px; position: sticky; top: 100px; height: fit-content; background: white; padding: 10px; border-radius: var(--radius-md); display: none; box-shadow: var(--shadow-sm); }
        .sidebar li { list-style: none; padding: 14px 20px; margin-bottom: 5px; border-radius: 12px; cursor: pointer; font-weight: 600; font-size: 14px; color: #86868b; transition: 0.2s; }
        .sidebar li:hover { background: #f5f5f7; color: var(--dark); }
        @media (min-width: 1024px) { .sidebar { display: block; } }

        .services-list { flex: 1; }
        .category-title { font-size: 24px; font-weight: 700; margin: 50px 0 25px 0; color: var(--dark); display: flex; align-items: center; scroll-margin-top: 120px; }
        .category-title::before { content: ''; display: block; width: 6px; height: 24px; background: var(--primary); border-radius: 4px; margin-right: 12px; }
        
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(270px, 1fr)); gap: 25px; }

        .card { background: white; border-radius: var(--radius-md); overflow: hidden; transition: 0.3s; border: 1px solid rgba(0,0,0,0.04); display: flex; flex-direction: column; box-shadow: var(--shadow-sm); }
        .card:hover { transform: translateY(-8px); box-shadow: var(--shadow-hover); }

        .card-img-container { height: 240px; background: #f9f9f9; display: flex; align-items: center; justify-content: center; padding: 30px; position: relative; }
        .card-img { max-height: 100%; max-width: 100%; object-fit: contain; mix-blend-mode: multiply; }
        
        .badge { position: absolute; top: 12px; left: 12px; background: rgba(255,255,255,0.9); backdrop-filter: blur(4px); font-size: 10px; font-weight: 700; padding: 6px 12px; border-radius: 99px; text-transform: uppercase; }
        .badge-promo { background: var(--promo); color: white; }
        .badge-eco { background: #34c759; color: white; }
        .badge-new { background: #0071e3; color: white; }
        .badge-oled { background: black; color: white; }
        
        .card-body { padding: 20px; flex: 1; display: flex; flex-direction: column; }
        .card-title { font-size: 17px; font-weight: 600; margin: 0 0 6px 0; }
        .card-desc { font-size: 13px; color: #86868b; margin-bottom: 15px; line-height: 1.4; flex: 1; }
        
        .toggle-tech { background: none; border: none; color: #0071e3; font-size: 12px; font-weight: 500; cursor: pointer; padding: 0; margin-bottom: 12px; text-align: left; }
        .tech-details { font-size: 11px; color: #555; margin-bottom: 15px; display: none; background: #f5f5f7; padding: 10px; border-radius: 8px; line-height: 1.5; }

        .price-row { display: flex; align-items: baseline; margin-bottom: 15px; }
        .price-old { text-decoration: line-through; color: #bbb; font-size: 14px; margin-right: 10px; font-weight: 500; }
        .price-current { font-size: 24px; font-weight: 700; color: var(--dark); }
        .price-promo { color: var(--promo); }

        .btn-buy { background: var(--green-gradient); color: white; border: none; padding: 14px; width: 100%; border-radius: 12px; font-weight: 600; cursor: pointer; font-size: 14px; transition: 0.2s; box-shadow: 0 4px 12px rgba(52, 199, 89, 0.3); }
        .btn-buy:hover { transform: translateY(-2px); box-shadow: 0 6px 16px rgba(52, 199, 89, 0.4); }

        /* MODAL */
        .modal-overlay { position: fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.4); backdrop-filter: blur(8px); display: none; justify-content: center; align-items: center; z-index: 2000; }
        .modal { background: white; padding: 35px; border-radius: 24px; width: 480px; max-width: 90%; position: relative; max-height: 90vh; overflow-y: auto; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25); }
        .modal-tech-info { background: #f5f9ff; border: 1px solid rgba(0, 113, 227, 0.1); padding: 15px; border-radius: 12px; font-size: 13px; color: #004085; margin-bottom: 25px; line-height: 1.6; }
        
        .price-recap { background: #fffdf5; padding: 15px; border-radius: 12px; margin-bottom: 25px; border: 1px solid rgba(255, 193, 7, 0.2); }
        .price-row-modal { display:flex; justify-content:space-between; margin-bottom:8px; font-size:14px; color: #555; }
        
        .form-group { margin-bottom: 20px; }
        .form-group label { font-weight: 600; font-size: 13px; display: block; margin-bottom: 8px; }
        .form-group input { width: 100%; padding: 14px; border: 1px solid #d2d2d7; border-radius: 12px; font-size: 15px; }
        .phone-group { display: flex; align-items: center; }
        .phone-prefix { background: #f5f5f7; border: 1px solid #d2d2d7; border-right: none; padding: 14px; border-radius: 12px 0 0 12px; font-weight: 600; color: #555; font-size: 15px; }
        #phoneInput { border-radius: 0 12px 12px 0; }
        
        .btn-confirm { background: var(--primary); color: white; border: none; padding: 16px; width: 100%; font-weight: 700; cursor: pointer; border-radius: 14px; font-size: 16px; transition: transform 0.2s; }
        .btn-confirm:hover { transform: scale(1.02); }

        /* AVIS */
        .reviews-section { max-width: 1200px; margin: 60px auto; background: white; padding: 50px; border-radius: var(--radius-md); box-shadow: var(--shadow-md); }
        .review-form input, .review-form textarea, .review-form select { border: 1px solid #d2d2d7; border-radius: 12px; padding: 12px; width: 100%; margin-bottom: 10px; font-family: inherit; }
        .review-item { border-bottom: 1px solid #eee; padding: 20px 0; position: relative; }
        .review-options { position: absolute; top: 15px; right: 0; }
        .dots-btn { background: none; border: none; font-size: 24px; cursor: pointer; color: #ccc; padding: 0 10px; }
        .options-menu { display: none; position: absolute; right: 0; top: 30px; background: white; border: 1px solid #eee; border-radius: 12px; box-shadow: var(--shadow-hover); z-index: 10; width: 140px; }
        .options-menu button { display: block; width: 100%; text-align: left; padding: 12px 15px; background: none; border: none; cursor: pointer; font-size: 13px; }
        .btn-delete { color: #ff3b30; }

        @media (max-width: 768px) { .container { flex-direction: column; padding: 15px; } .sidebar { display: none; } .modal { width: 90%; padding: 25px; } .grid { grid-template-columns: 1fr; } }
    </style>
</head>
<body>

    <header>
        <div class="logo">repairphonebx<span style="color:var(--primary)">.</span></div>
        <button class="btn-contact" id="contactBtn" onclick="showNumber()">Nous contacter</button>
    </header>

    <div class="hero">
        <div class="promo-banner">üî• PROMO FIN NOVEMBRE</div>
        <h1>R√©paration iPhone Express</h1>
        <p style="margin-bottom: 20px;">üìç Ribaucourt, 1080 Molenbeek</p>
        <div style="display:inline-flex; gap:10px; flex-wrap:wrap; justify-content:center;">
            <span style="background:#f0f0f0; padding:5px 12px; border-radius:8px; font-size:13px; font-weight:500;">‚úÖ 30 minutes</span>
            <span style="background:#f0f0f0; padding:5px 12px; border-radius:8px; font-size:13px; font-weight:500;">üíé Pi√®ces Premium</span>
            <span style="background:#f0f0f0; padding:5px 12px; border-radius:8px; font-size:13px; font-weight:500;">üõ°Ô∏è Garantie incluse</span>
        </div>
    </div>

    <div class="search-container">
        <span class="search-icon">üîç</span>
        <input type="text" class="search-input" id="searchInput" placeholder="Rechercher votre mod√®le (ex: iPhone 13)..." onkeyup="filterServices()">
    </div>

    <div class="container">
        <div class="sidebar">
            <ul>
                <li onclick="scrollToSection('eco')">üçè GAMME √âCO (Petits Prix)</li>
                <li onclick="scrollToSection('promo')">üî• PROMO FLASH (50‚Ç¨)</li>
                <li onclick="scrollToSection('normal')">üì± √âCRANS (Max)</li>
                <li onclick="scrollToSection('oled')">üíé GAMME OLED (15/16)</li>
                <li onclick="scrollToSection('batterie')">üîã BATTERIES</li>
                <li onclick="scrollToSection('avis')">‚≠ê AVIS CLIENTS</li>
            </ul>
        </div>

        <div class="services-list">

            <h2 class="category-title" id="eco">GAMME √âCO (Petits Prix)</h2>
            <div id="eco-grid" class="grid"></div>

            <h2 class="category-title" id="promo">PROMO FLASH 50‚Ç¨</h2>
            <div id="promo-grid" class="grid"></div>

            <h2 class="category-title" id="normal">√âCRANS HORS PROMO</h2>
            <div id="normal-grid" class="grid"></div>

            <h2 class="category-title" id="oled">√âCRANS OLED (NOUVEAUT√âS)</h2>
            <div id="oled-grid" class="grid"></div>

            <h2 class="category-title" id="batterie">BATTERIES NEUVES</h2>
            <div id="battery-grid" class="grid"></div>
        </div>
    </div>

    <div class="reviews-section" id="avis">
        <h3>Avis Clients</h3>
        <div class="review-form">
            <input type="text" id="reviewName" placeholder="Votre nom">
            <select id="reviewRating">
                <option value="5">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê - Excellent</option>
                <option value="4">‚≠ê‚≠ê‚≠ê‚≠ê - Tr√®s bon</option>
                <option value="3">‚≠ê‚≠ê‚≠ê - Moyen</option>
                <option value="2">‚≠ê‚≠ê - Bof</option>
                <option value="1">‚≠ê - Mauvais</option>
            </select>
            <textarea id="reviewContent" placeholder="Racontez votre exp√©rience..."></textarea>
            <button class="btn-contact" onclick="submitReview()" style="margin-top: 10px; width: 100%;">Publier l'avis</button>
        </div>
        <div id="reviews-display" style="margin-top: 40px;"></div>
    </div>

    <div style="max-width: 1200px; margin: 0 auto; padding: 20px; margin-bottom: 40px;">
        <h2 style="text-align:center; color:var(--dark); margin-bottom:20px;">üìç Nous trouver</h2>
        <div style="width: 100%; height: 400px; border-radius: 24px; overflow: hidden; box-shadow: 0 10px 30px rgba(0,0,0,0.1); border: 1px solid rgba(0,0,0,0.05);">
            <iframe 
                src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2518.6351136143165!2d4.338582376946546!3d50.85647537167196!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x47c3c3939274a6b3%3A0x40e3c7171247d925!2sRibaucourt!5e0!3m2!1sfr!2sbe!4v1700000000000!5m2!1sfr!2sbe" 
                width="100%" height="100%" style="border:0;" allowfullscreen="" loading="lazy"></iframe>
        </div>
    </div>

    <div class="modal-overlay" id="legalModal">
        <div class="modal modal-large">
            <button onclick="document.getElementById('legalModal').style.display='none'" style="position:absolute; top:20px; right:20px; border:none; background:none; font-size:24px; cursor:pointer;">√ó</button>
            <h2>Mentions L√©gales</h2>
            <div style="font-size:14px; line-height:1.6; color:#555;">
                <p><strong>1. √âditeur</strong><br>Repair Phone BX<br>Ribaucourt, 1080 Molenbeek</p>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="bookingModal">
        <div class="modal">
            <button onclick="closeModal()" style="position:absolute; top:20px; right:20px; border:none; background:none; font-size:24px; cursor:pointer;">√ó</button>
            <h2>R√©server</h2>
            <div id="techInfoModal" class="modal-tech-info"></div>
            <div class="price-recap">
                <div class="price-row-modal" style="font-weight:600; border-bottom:1px solid #e0e0e0; padding-bottom:10px; margin-bottom:10px; color:#333;">
                    <span id="selectedServiceDisplay">Service</span>
                </div>
                <div class="price-row-modal"><span>Prix Total :</span><span id="displayTotal">0 ‚Ç¨</span></div>
                <div class="price-row-modal" style="color:#b45309; font-weight:bold;"><span>Acompte (Carte) :</span><span>15 ‚Ç¨</span></div>
                <div class="price-row-modal" style="color:var(--dark); font-weight:600;"><span>Reste √† payer (Sur place) :</span><span id="displayRest">0 ‚Ç¨</span></div>
            </div>
            <div class="form-group"><label>Nom Complet</label><input type="text" id="nameInput" placeholder="Pr√©nom Nom"></div>
            <div class="form-group"><label>Email (Pour le re√ßu)</label><input type="email" id="emailInput" placeholder="exemple@gmail.com"></div>
            <div class="form-group"><label>T√©l√©phone</label><div class="phone-group"><span class="phone-prefix">+32</span><input type="number" id="phoneInput" placeholder="467 12 34 56"></div></div>
            <div class="form-group"><label>Date</label><input type="date" id="dateInput"></div>
            <button class="btn-confirm" onclick="confirmBooking()">Payer l'acompte (15‚Ç¨)</button>
        </div>
    </div>

    <script>
        // ‚ö†Ô∏è TON LIEN RENDER ICI
        const API_URL = 'https://repair-phone-bx-1.onrender.com';
        
        let currentPrice = 0;
        let selectedService = "";

        const techLCD = `<strong>Norme :</strong> √âcran LCD LTPS (Qualit√©/Prix)<br><strong>Solidit√© :</strong> Verre renforc√©.<br><strong>Couleurs :</strong> Gamut P3 vives.<br><strong>R√©activit√© :</strong> Tactile fluide.`;
        const techOLED = `<strong>Technologie :</strong> √âcran COMPATIBLE OLED<br><strong>Qualit√© :</strong> Affichage exceptionnel d'origine.`;

        [cite_start]// --- 1. GAMME ECO (Prix PDF, pas de promo) [cite: 5-7] ---
        const ecoModels = [
            {m: "iPhone X", p: 40, img: "images/iphone-X-noir.jpg"}, 
            {m: "iPhone XS", p: 40, img: "images/iphone-XS-.jpg"},
            {m: "iPhone XR", p: 45, img: "images/apple-iphone-XR-.jpg"},
            {m: "iPhone XS Max", p: 45, img: "images/apple-iphone-XSmax.jpg"}, // Chang√© de promo √† eco (car 45‚Ç¨ sur PDF)
            {m: "iPhone 11", p: 50, img: "images/apple-iphone-11.jpg"}, 
            {m: "iPhone 11 Pro", p: 50, img: "images/apple-iphone-11Pro.jpg"}
        ];

        // --- 2. LA VRAIE PROMO (Prix barr√© -> 50‚Ç¨) ---
        const promoModels = [
            {m: "iPhone 11 Pro Max", old: 60, img: "images/iphone-11ProMax.jpg"},
            {m: "iPhone 12", old: 70, img: "images/apple-iphone-12.jpg"}, 
            {m: "iPhone 12 Mini", old: 70, img: "images/apple-iphone-12-mini.jpg"}, 
            {m: "iPhone 12 Pro", old: 75, img: "images/apple-iphone-12Pro.jpg"}, 
            {m: "iPhone 12 Pro Max", old: 85, img: "images/iphone-12ProMax.jpg"},
            {m: "iPhone 13", old: 80, img: "images/apple-iphone-13.jpg"}, 
            {m: "iPhone 13 Mini", old: 75, img: "images/apple-iphone-13-mini.jpg"}, 
            {m: "iPhone 13 Pro", old: 155, img: "images/apple-iphone-13Pro.jpg"}, 
            {m: "iPhone 14", old: 80, img: "images/apple-iphone-14.jpg"}, 
            {m: "iPhone 14 Plus", old: 90, img: "images/apple-iphone-14-Plus.jpg"}, 
            {m: "iPhone 14 Pro", old: 155, img: "images/apple-iphone-14Pro.jpg"}
        ];

        // --- 3. HORS PROMO (13PM, 14PM) ---
        const horsPromo = [
            {m: "iPhone 13 Pro Max", p: 180, type: "LCD", img: "images/iphone-13ProMax.jpg"},
            {m: "iPhone 14 Pro Max", p: 180, type: "LCD", img: "images/iphone-14-pro-max.jpg"}
        ];

        // --- 4. OLED (15, 16) ---
        const oledModels = [
            {m: "iPhone 15", p: 75, type: "OLED", img: "images/iphone-15.jpg"},
            {m: "iPhone 15 Plus", p: 75, type: "OLED", img: "images/iphone-15Plus.jpg"},
            {m: "iPhone 15 Pro", p: 85, type: "OLED", img: "images/iphone-15Pro.jpg"},
            {m: "iPhone 15 Pro Max", p: 150, type: "OLED", img: "images/iphone-15ProMax.jpg"},
            {m: "iPhone 16", p: 100, type: "OLED", img: "images/iphone-16.jpg"},
            {m: "iPhone 16 Plus", p: 150, type: "OLED", img: "images/iphone-16Plus.jpg"},
            {m: "iPhone 16 E", p: 150, type: "OLED", img: "images/iphone-16E.jpg"},
            {m: "iPhone 16 Pro", p: 150, type: "OLED", img: "images/iphone-16Pro.jpg"},
            {m: "iPhone 16 Pro Max", p: 200, type: "OLED", img: "images/iphone-16ProMax.jpg"}
        ];

        // --- 5. BATTERIES ---
        const batteries = [
            { m: "iPhone X", p: 40, img: "images/iphone-X-noir.jpg" }, { m: "iPhone XS", p: 40, img: "images/iphone-XS-.jpg" },
            { m: "iPhone XR", p: 45, img: "images/apple-iphone-XR-.jpg" }, { m: "iPhone XS Max", p: 45, img: "images/apple-iphone-XSmax.jpg" }, 
            { m: "iPhone 11", p: 45, img: "images/apple-iphone-11.jpg" }, { m: "iPhone 11 Pro", p: 45, img: "images/apple-iphone-11Pro.jpg" }, 
            { m: "iPhone 11 Pro Max", p: 55, img: "images/iphone-11ProMax.jpg" }, { m: "iPhone 12", p: 60, img: "images/apple-iphone-12.jpg" }, 
            { m: "iPhone 12 Mini", p: 70, img: "images/apple-iphone-12-mini.jpg" }, { m: "iPhone 12 Pro", p: 60, img: "images/apple-iphone-12Pro.jpg" }, 
            { m: "iPhone 12 Pro Max", p: 80, img: "images/iphone-12ProMax.jpg" }, { m: "iPhone 13", p: 80, img: "images/apple-iphone-13.jpg" }, 
            { m: "iPhone 13 Mini", p: 80, img: "images/apple-iphone-13-mini.jpg" }, { m: "iPhone 13 Pro", p: 150, img: "images/apple-iphone-13Pro.jpg" }, 
            { m: "iPhone 13 Pro Max", p: 170, img: "images/iphone-13ProMax.jpg" }, { m: "iPhone 14", p: 80, img: "images/apple-iphone-14.jpg" }, 
            { m: "iPhone 14 Plus", p: 90, img: "images/apple-iphone-14-Plus.jpg" }, { m: "iPhone 14 Pro", p: 150, img: "images/apple-iphone-14Pro.jpg" }, 
            { m: "iPhone 14 Pro Max", p: 170, img: "images/iphone-14-pro-max.jpg" }
        ];

        // GENERATION HTML
        function createCard(item, type) {
            let badge = "", oldPriceHtml = "", desc = "", tech = "";
            
            if (type === "PROMO") {
                badge = `<div class="badge badge-promo">-50%</div>`;
                oldPriceHtml = `<span class="price-old">${item.old}‚Ç¨</span>`;
                desc = "Remplacement √âcran LCD";
                tech = techLCD;
            } else if (type === "ECO") {
                badge = `<div class="badge badge-eco">TOP PRIX</div>`; 
                desc = "Remplacement √âcran LCD";
                tech = techLCD;
            } else if (type === "OLED") {
                badge = `<div class="badge badge-new">NOUVEAU</div>`;
                desc = "Remplacement √âcran OLED Premium";
                tech = techOLED;
            } else if (type === "NORMAL") {
                desc = "Remplacement √âcran LCD Premium";
                tech = techLCD;
            } else {
                badge = `<div class="badge">ORIGINE</div>`;
                desc = "Batterie neuve haute capacit√©";
            }

            let price = type === "PROMO" ? 50 : item.p;
            let serviceName = type === "BATTERIE" ? `${item.m} - Batterie` : `${item.m} - √âcran`;
            
            return `
            <div class="card">
                <div class="card-img-container">
                    ${badge}
                    <img src="${item.img}" class="card-img" alt="${item.m}">
                </div>
                <div class="card-body">
                    <div class="card-title">${serviceName}</div>
                    <div class="card-desc">${desc}</div>
                    ${type !== "BATTERIE" ? `<button class="toggle-tech" onclick="toggleTech(this)">Voir d√©tails techniques</button><div class="tech-details">${tech}</div>` : ''}
                    <div class="price-row">
                        ${oldPriceHtml}
                        <span class="price-current ${type === 'PROMO' ? 'price-promo' : ''}">${price} ‚Ç¨</span>
                    </div>
                    <button class="btn-buy" onclick="openBooking('${serviceName}', ${price}, '${type}')">R√âSERVER</button>
                </div>
            </div>`;
        }

        // RENDER
        document.getElementById('eco-grid').innerHTML = ecoModels.map(i => createCard(i, "ECO")).join('');
        document.getElementById('promo-grid').innerHTML = promoModels.map(i => createCard(i, "PROMO")).join('');
        document.getElementById('normal-grid').innerHTML = horsPromo.map(i => createCard(i, "NORMAL")).join('');
        document.getElementById('oled-grid').innerHTML = oledModels.map(i => createCard(i, "OLED")).join('');
        document.getElementById('battery-grid').innerHTML = batteries.map(i => createCard(i, "BATTERIE")).join('');

        function filterServices() {
            const query = document.getElementById('searchInput').value.toLowerCase();
            document.querySelectorAll('.card').forEach(card => {
                card.style.display = card.innerText.toLowerCase().includes(query) ? 'flex' : 'none';
            });
        }

        function toggleTech(btn) { const d = btn.nextElementSibling; d.style.display = d.style.display === 'block' ? 'none' : 'block'; btn.innerText = d.style.display === 'block' ? 'Masquer' : 'Voir caract√©ristiques'; }
        function showNumber() { document.getElementById('contactBtn').innerText = "üìû 0467 79 17 37"; }
        function scrollToSection(id) { document.getElementById(id).scrollIntoView({behavior: 'smooth'}); }

        function openBooking(service, price, type) {
            selectedService = service;
            currentPrice = price;
            
            const techModal = document.getElementById('techInfoModal');
            if (type === "OLED") techModal.innerHTML = `<strong>üíé √âcran OLED :</strong> Qualit√© d'origine, noirs parfaits, contraste infini.`;
            else if (type === "PROMO" || type === "NORMAL" || type === "ECO") techModal.innerHTML = `<strong>üì± √âcran LCD LTPS :</strong> Solidit√© renforc√©e, excellent rapport qualit√©/prix.`;
            else techModal.innerHTML = `<strong>üîã Batterie Neuve :</strong> Haute capacit√©, garantie incluse.`;

            const acompte = 15;
            const reste = price - acompte;

            document.getElementById('selectedServiceDisplay').innerText = service;
            document.getElementById('displayTotal').innerText = price + " ‚Ç¨";
            document.getElementById('displayRest').innerText = reste + " ‚Ç¨";

            document.getElementById('bookingModal').style.display = 'flex';
            const input = document.getElementById('dateInput');
            const now = new Date();
            const endOfMonth = new Date(now.getFullYear(), now.getMonth() + 1, 0);
            input.min = now.toISOString().split('T')[0];
            input.max = endOfMonth.toISOString().split('T')[0];
        }

        function closeModal() { document.getElementById('bookingModal').style.display = 'none'; }

        async function confirmBooking() {
            const name = document.getElementById('nameInput').value;
            const email = document.getElementById('emailInput').value;
            const phone = document.getElementById('phoneInput').value;
            const date = document.getElementById('dateInput').value;
            if(!name || !email || !phone || !date) return alert("Remplissez tout !");
            if(phone.length !== 9) return alert("‚ö†Ô∏è Num√©ro invalide ! (9 chiffres apr√®s +32)");
            if(phone.startsWith('0')) return alert("Pas de 0 au d√©but du num√©ro !");
            
            const cleanPhone = "+32" + phone;
            const btn = document.querySelector('.btn-confirm');
            btn.innerText = "Chargement...";
            btn.disabled = true;
            
            try {
                const res = await fetch(API_URL + '/create-checkout-session', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({ client_name: name, email: email, phone: cleanPhone, service_type: selectedService, date: date, price: currentPrice })
                });
                const data = await res.json();
                if(data.url) window.location.href = data.url;
                else { alert("Erreur Stripe"); btn.disabled = false; }
            } catch (e) { alert("Erreur serveur"); btn.disabled = false; }
        }
        
        const badWords = ["merde", "con", "sex", "salope", "pute", "raciste", "nazi", "hitler", "baiser", "cul", "idiot", "pd", "connard"];
        let myReviews = JSON.parse(localStorage.getItem('my_reviews') || '[]');
        async function submitReview() {
            const name = document.getElementById('reviewName').value;
            const content = document.getElementById('reviewContent').value;
            const rating = document.getElementById('reviewRating').value;
            for (let w of badWords) { if (content.toLowerCase().includes(w)) { alert("‚õî Mod√©ration"); return; } }
            if(!name || !content) return alert("Champs vides");
            const res = await fetch(API_URL + '/reviews', { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({ author: name, content: content, rating: rating }) });
            const data = await res.json();
            if(data.success && data.id) { myReviews.push(data.id); localStorage.setItem('my_reviews', JSON.stringify(myReviews)); alert("Avis publi√© !"); document.getElementById('reviewContent').value = ""; loadReviews(); }
        }
        async function loadReviews() {
            try {
                const res = await fetch(API_URL + '/reviews');
                const reviews = await res.json();
                document.getElementById('reviews-display').innerHTML = reviews.map(r => {
                    let menu = myReviews.includes(r.id) ? `<div class="review-options"><button class="dots-btn" onclick="toggleMenu(${r.id})">‚ãÆ</button><div id="menu-${r.id}" class="options-menu"><button onclick="editReview(${r.id})">‚úèÔ∏è Modifier</button><button class="btn-delete" onclick="deleteReview(${r.id})">üóëÔ∏è Supprimer</button></div></div>` : "";
                    return `<div class="review-item">${menu}<strong>${r.author}</strong> <span style="color:#ffc107">${'‚≠ê'.repeat(r.rating)}</span><p id="content-${r.id}">${r.content}</p></div>`;
                }).join('');
            } catch(e) {}
        }
        function toggleMenu(id) { const m = document.getElementById(`menu-${id}`); m.style.display = m.style.display === 'block' ? 'none' : 'block'; }
        async function deleteReview(id) { if(!confirm("Supprimer ?")) return; await fetch(API_URL + '/reviews/' + id, { method: 'DELETE' }); myReviews = myReviews.filter(i => i !== id); localStorage.setItem('my_reviews', JSON.stringify(myReviews)); loadReviews(); }
        async function editReview(id) { const n = prompt("Modifier :", document.getElementById(`content-${id}`).innerText); if(n) { await fetch(API_URL + '/reviews/' + id, { method: 'PUT', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({ content: n, rating: 5 }) }); loadReviews(); } }
        loadReviews();
    </script>

    <footer style="text-align: center; padding: 30px 10px; color: #bbb; font-size: 12px; margin-top: 40px; border-top: 1px solid #eee;">
        ¬© 2025 Repair Phone BX - Tous droits r√©serv√©s.<br>
        <a href="#" onclick="document.getElementById('legalModal').style.display='flex'; return false;" style="color: #999; text-decoration: underline;">Mentions L√©gales & CGV</a>
        <br><br>
        <a href="/admin-secret-panel" style="color: #eee; text-decoration: none;">Panel Admin</a>
    </footer>
</body>
</html>